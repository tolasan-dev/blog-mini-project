<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Viewprofile</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<style>
    /* small custom styles for nicer card appearance */
    .card-article {
      border-radius: 12px;
      overflow: hidden;
      transition: transform 0.18s ease, box-shadow 0.18s ease;
      cursor: pointer;
    }
    .card-article:hover {
      transform: translateY(-6px);
      box-shadow: 0 10px 30px rgba(0,0,0,0.12);
    }
    .card-img-top {
      height: 200px;
      object-fit: cover;
    }
    .card-date {
      font-size: 0.85rem;
    }
  </style>
<body>
     <div class="container py-5">

    <!-- Grid of cards -->
     <div class="d-flex flex-column align-items-end" id="proDis">
          <div class="welcome" id="welcomeMessage">Welcome, .....!</div>
          <div class="email" id="email">example@gmail.com</div>
      </div>
    <div class="row g-4" id="disProArt">
      <!-- Card 1 -->
    </div>
    

    
    
</body>
 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
 <script>
      mytoken = localStorage.getItem("token");
      let article_id = localStorage.getItem("article_id");
      let disPro = document.getElementById("disPro");
      fetch("http://blogs.csm.linkpc.net/api/v1/articles/" + article_id, {
          headers: { Authorization: `Bearer ${mytoken}` },
      })
      .then((res) => res.json())
      .then((data) => {
           console.log("data", data.data.creator);
           let profile = data.data.creator;
           proDis.innerHTML = `
             .<div class="d-flex align-items-center mb-3">
               <img
                src="${profile.avatar}"
                width="60"
                height="60"
                style="border-radius: 50%; object-fit: cover;"
              />
              <div class="ms-3">
                <h6 class="mb-0">${profile.firstName} ${profile.lastName}</h6>
                <small>ID: ${profile.id}</small>
              </div>
             </div>
           `;
      });
 </script>
<script>
    mytoken = localStorage.getItem("token");
    let profile_id = localStorage.getItem("profile_id");
    let disProArt = document.getElementById("disProArt");
    fetch("http://blogs.csm.linkpc.net/api/v1/articles/by/"+profile_id+"?search=&_page=1&_per_page=10&sortBy=createdAt&sortDir=asc")
    .then (res => res.json())
    .then (data => {
      console.log(data);
      
        
        data.data.items.forEach(element => {
            console.log(element);

            disProArt.innerHTML += `
            <div class="col-12 col-sm-6 col-md-4">
                <div class="card card-article h-100">
                <img src="${element.thumbnail}" class="card-img-top" alt="Article image">
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title mb-2">${element.title}</h5>
                    <p class="card-text text-muted mb-3">
                        ${element.content.substring(0, 100)}...
                    </p>
                    <div class="mt-auto d-flex justify-content-between align-items-center">
                    <small class="text-muted card-date">${convertDate(element.createdAt)}</small>
                    <button onclick="clickRead(${element.id})">Read</button>
                    </div>
                </div>
                </div>
            </div>
            `
            
        });
    })

    function convertDate (date){
        console.log(date);
        let conDate = new Date(date);
        console.log(conDate.toLocaleDateString());
        return conDate.toLocaleDateString();
    }

    function clickRead(id) {
        localStorage.setItem("article_id", id);
        location.href = "../pages/detailview-pro.html";
    }

</script>
</html>